---
interface Props {
  aboutImage1: string;
  aboutImage2: string;
}

const { aboutImage1, aboutImage2 } = Astro.props;
---

<section id="about" class="max-w-7xl mx-auto px-6 py-16 text-center">
  <h2 class="text-5xl sm:text-4xl font-light text-[#1a1a1a] mb-12">About Gigi Fairview Design</h2>

  <div class="space-y-16 max-w-5xl mx-auto">
    <!-- Split Hero: Image Left, Copy Right -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8 items-center">
      <p class="about-text-block text-lg sm:text-base text-gray-700 leading-relaxed text-left font-pt-mono">
        Gigi Fairview Design is proud to offer outdoor furniture crafted in Juarez, Mexico and indoor furniture made in Mexico, Europe, the United States, and Indonesia. Our curated selections include exceptional outdoor and indoor furniture, fabrics, as well as exquisite accessories, all designed to elevate your living space.
      </p>
      <div class="about-image-block relative min-h-[250px] h-80 md:h-[400px] overflow-hidden">
        <img
          src={aboutImage1}
          alt="Gigi Fairview Design Image 1"
          class="absolute inset-0 w-full h-full object-cover"
          style="image-rendering: -webkit-optimize-contrast;"
        />
      </div>
    </div>

    <!-- Second Row: Image Left, Text Right -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-x-12 gap-y-8 items-center">
      <div class="about-image-block relative min-h-[250px] h-80 md:h-[400px] overflow-hidden md:order-1">
        <img
          src={aboutImage2}
          alt="Gigi Fairview Design Image 2"
          class="absolute inset-0 w-full h-full object-cover"
          style="image-rendering: -webkit-optimize-contrast;"
        />
      </div>
      <div id="services-section" class="about-text-block text-left md:order-2 font-pt-mono">
        <h3 class="text-xl sm:text-2xl font-semibold text-[#1a1a1a] mb-4">Our Services</h3>
        <ul class="list-disc pl-5 space-y-2">
          <li>Professional and ASID licensed design</li>
          <li>Space planning with advanced 2D/3D software</li>
          <li>Seamless white-glove installation with removal of all packing material</li>
          <li>Timely delivery, with average ordering times of 6-12 weeks</li>
          <li>Our team is bilingual and fluent in both English and Español' for our valued clientele</li>
        </ul>
      </div>
    </div>
  </div>
</section>

<!-- Process / Pricing Section -->
<section id="process-pricing" class="max-w-7xl mx-auto px-6 py-16">
  <h2 class="text-5xl sm:text-4xl font-light text-[#1a1a1a] mb-12 text-center">Process / Pricing</h2>

  <!-- Desktop: Horizontal timeline -->
  <div class="hidden md:block">
    <div class="relative mx-auto max-w-5xl pt-10">
      <div class="absolute inset-x-0 top-5 h-px bg-gray-200"></div>
      <ul class="grid grid-cols-5 gap-6">
        <li class="flex flex-col items-center">
          <span class="z-10 flex h-10 w-10 items-center justify-center rounded-full bg-black text-white text-sm">1</span>
          <div class="mt-4 text-center">
            <h3 class="text-base font-semibold text-[#1a1a1a]">Step One</h3>
            <p class="text-sm text-gray-700 max-w-[14rem]">Contact Gigi Fairview Design • Complete Design Project Questionnaire</p>
          </div>
        </li>
        <li class="flex flex-col items-center">
          <span class="z-10 flex h-10 w-10 items-center justify-center rounded-full bg-black text-white text-sm">2</span>
          <div class="mt-4 text-center">
            <h3 class="text-base font-semibold text-[#1a1a1a]">Step Two</h3>
            <p class="text-sm text-gray-700 max-w-[14rem]">Measurement Appointment • Initial Design Consultation</p>
          </div>
        </li>
        <li class="flex flex-col items-center">
          <span class="z-10 flex h-10 w-10 items-center justify-center rounded-full bg-black text-white text-sm">3</span>
          <div class="mt-4 text-center">
            <h3 class="text-base font-semibold text-[#1a1a1a]">Step Three</h3>
            <p class="text-sm text-gray-700 max-w-[14rem]">2D Design • Presentation</p>
          </div>
        </li>
        <li class="flex flex-col items-center">
          <span class="z-10 flex h-10 w-10 items-center justify-center rounded-full bg-black text-white text-sm">4</span>
          <div class="mt-4 text-center">
            <h3 class="text-base font-semibold text-[#1a1a1a]">Step Four</h3>
            <p class="text-sm text-gray-700 max-w-[14rem]">Final Consultation • 3D Design • Initial Payment</p>
          </div>
        </li>
        <li class="flex flex-col items-center">
          <span class="z-10 flex h-10 w-10 items-center justify-center rounded-full bg-black text-white text-sm">5</span>
          <div class="mt-4 text-center">
            <h3 class="text-base font-semibold text-[#1a1a1a]">Step Five</h3>
            <p class="text-sm text-gray-700 max-w-[14rem]">Delivery • Final Payment</p>
          </div>
        </li>
      </ul>
    </div>
  </div>

  <!-- Mobile: Vertical list -->
  <div class="md:hidden max-w-4xl mx-auto text-left">
    <ol class="relative border-s border-gray-200 pl-6">
      <li class="mb-10 ms-6"><span class="absolute -start-3 flex h-6 w-6 items-center justify-center rounded-full bg-black text-white text-xs">1</span><h3 class="text-base font-semibold text-[#1a1a1a]">Step One</h3><p class="text-sm text-gray-700">Contact Gigi Fairview Design • Complete Design Project Questionnaire</p></li>
      <li class="mb-10 ms-6"><span class="absolute -start-3 flex h-6 w-6 items-center justify-center rounded-full bg-black text-white text-xs">2</span><h3 class="text-base font-semibold text-[#1a1a1a]">Step Two</h3><p class="text-sm text-gray-700">Measurement Appointment • Initial Design Consultation</p></li>
      <li class="mb-10 ms-6"><span class="absolute -start-3 flex h-6 w-6 items-center justify-center rounded-full bg-black text-white text-xs">3</span><h3 class="text-base font-semibold text-[#1a1a1a]">Step Three</h3><p class="text-sm text-gray-700">2D Design • Presentation</p></li>
      <li class="mb-10 ms-6"><span class="absolute -start-3 flex h-6 w-6 items-center justify-center rounded-full bg-black text-white text-xs">4</span><h3 class="text-base font-semibold text-[#1a1a1a]">Step Four</h3><p class="text-sm text-gray-700">Final Consultation • 3D Design • Initial Payment</p></li>
      <li class="ms-6"><span class="absolute -start-3 flex h-6 w-6 items-center justify-center rounded-full bg-black text-white text-xs">5</span><h3 class="text-base font-semibold text-[#1a1a1a]">Step Five</h3><p class="text-sm text-gray-700">Delivery • Final Payment</p></li>
    </ol>
  </div>

  <p class="text-lg sm:text-base text-gray-700 leading-relaxed mt-10 text-center">
    All quotes include consultations, design, furnishings, delivery, and setup.
  </p>
</section>

<!-- Giving Band (moved below Process) -->
<section id="giving" class="w-full py-16 sm:py-20 bg-[#f7f7f7]">
  <div class="max-w-5xl mx-auto px-6 text-center">
    <p class="text-xs tracking-[.3em] uppercase mb-3 text-gray-500">Giving Back</p>
    <h2 class="text-3xl sm:text-4xl font-light leading-tight mb-4 text-[#1a1a1a]">A portion of every project supports local animal rescues</h2>
    <p class="text-base sm:text-lg font-pt-mono mb-6 text-[#1a1a1a]">Animalandia • Soft Paws • Manu Palma</p>
    <div class="flex flex-wrap items-center justify-center gap-3">
      <a href="https://www.facebook.com/animalandialoreto/mentions/" target="_blank" rel="noopener noreferrer" class="px-4 py-2 rounded-full border border-gray-300 text-[#1a1a1a] hover:bg-black hover:text-white transition-colors text-sm">Animalandia</a>
      <a href="https://softpawsloreto.org/" target="_blank" rel="noopener noreferrer" class="px-4 py-2 rounded-full border border-gray-300 text-[#1a1a1a] hover:bg-black hover:text-white transition-colors text-sm">Soft Paws</a>
    </div>
  </div>
</section>

<style>
  #process-steps .wheel-step {
    position: absolute;
    width: 42px; height: 42px;
    display: flex; align-items: center; justify-content: center;
    border-radius: 9999px;
    background: white; color: #111; border: 1px solid #e5e7eb;
    transition: transform .2s ease, box-shadow .2s ease, background .2s ease, color .2s ease;
    box-shadow: 0 2px 8px rgba(0,0,0,.06);
  }
  #process-steps .wheel-step.active { background: #111; color: #fff; border-color: #111; }
  @media (prefers-reduced-motion: reduce) {
    #process-progress { transition: none !important; }
    #process-steps .wheel-step { transition: none !important; }
  }
  .about-text-block.active,
  .about-image-block.active {
    opacity: 1;
    transform: translateX(0) translateY(0);
  }
</style>

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    const progress = document.getElementById('process-progress');
    const ring = document.getElementById('process-ring');
    const steps = Array.from(document.querySelectorAll('#process-steps .wheel-step'));
    const details = Array.from(document.querySelectorAll('#process-details .process-detail'));
    if (!progress || !ring || steps.length === 0) return;

    const R = 150; // radius to edge of stroke
    const center = { x: 170, y: 170 };
    const circumference = 2 * Math.PI * R;
    const total = steps.length;
    progress.style.strokeDasharray = String(circumference);
    progress.style.strokeDashoffset = String(circumference);

    // Position markers around the circle
    steps.forEach((el, i) => {
      const angle = (-90 + (360 / total) * i) * (Math.PI / 180); // start at top
      const r = R; // marker orbit radius
      const x = center.x + r * Math.cos(angle);
      const y = center.y + r * Math.sin(angle);
      const host = el.parentElement; // absolute container sized like SVG
      if (!host) return;
      // Convert SVG coords to host absolute coords (they overlap in size)
      el.style.left = `${x - 21}px`;
      el.style.top = `${y - 21}px`;
    });

    function setActive(index) {
      steps.forEach((s, i) => s.classList.toggle('active', i === index));
      details.forEach((d, i) => d.classList.toggle('hidden', i !== index));
      const portion = (index + 1) / total; // progress through steps
      const offset = circumference * (1 - portion);
      progress.style.transition = 'stroke-dashoffset .6s ease';
      progress.style.strokeDashoffset = String(offset);
    }

    // Default to first step
    setActive(0);

    steps.forEach((btn, i) => {
      btn.addEventListener('click', () => setActive(i));
    });

    // Animate in on intersect
    const wheelSection = document.getElementById('process-pricing');
    const io = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          setActive(0);
        }
      });
    }, { threshold: .3 });
    if (wheelSection) io.observe(wheelSection);

    const targets = document.querySelectorAll('.about-text-block, .about-image-block');
    if (targets.length === 0) return;

    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add('active');
        }
      });
    }, { threshold: 0.1 });

    targets.forEach((el) => observer.observe(el));

    // Fallback: ensure visible after short delay
    setTimeout(() => {
      targets.forEach((el) => el.classList.add('active'));
    }, 300);
  });
</script>
